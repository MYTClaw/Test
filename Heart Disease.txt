                                       EXP: 1
Consider the following schema for Employee Database:
EMP(Fname, SSN, Bdate, Address, Sex, Salary, Mssn,DNO)
DEPARTMENT (Dept_name, Dnumber ,mgrssn , mgrstartdate)
DEPT_LOCATION (Dnumber,Dlocation)
PROJECT(Pname,Pnumber, Plocation, Dnum)
WORKS_ON(ESSN,Pno, Hours)
DEPENDENT(ESSN,Dname,Sex,Relationship)
Write SQL statements to
1. Create table for the database given above , assume appropriate data type for
columns specified for each table
2. Add the column Lname and Minit in EMP table
3. Rename table EMP to EMPLOYEE
4. Rename column MSSN to SuperSSN
5. Insert relevant records in all the tables.


CREATE TABLE DEPARTMENT
(DNO VARCHAR(20) PRIMARY KEY,
DNAME VARCHAR(20),
MGRSTARTDATE DATE);


CREATE TABLE EMPLOYEE
(SSN VARCHAR(20) PRIMARY KEY,
FNAME VARCHAR(20),
Bdate DATE,
ADDRESS VARCHAR2 (20),
SEX CHAR (1),
SALARY INTEGER,
SUPERSSN REFERENCES EMPLOYEE (SSN),
DNO REFERENCES DEPARTMENT (DNO));


ALTER TABLE DEPARTMENT
ADD MGRSSN REFERENCES EMPLOYEE (SSN);


CREATE TABLE DEPT_LOCATION
(DLOC VARCHAR2 (20),
DNO REFERENCES DEPARTMENT (DNO),
PRIMARY KEY (DNO, DLOC));


CREATE TABLE PROJECT
(PNO INTEGER PRIMARY KEY,
PNAME VARCHAR (20),
PLOCATION VARCHAR (20),
DNO REFERENCES DEPARTMENT(DNO));


CREATE TABLE WORKS_ON
(HOURS NUMBER (2),
SSN REFERENCES EMPLOYEE (SSN),
PNO REFERENCES PROJECT(PNO),
PRIMARY KEY (SSN, PNO));


CREATE TABLE DEPENDENT
(Depname VARCHAR (20),
Sex CHAR (1),
Relationship VARCHAR (20),
ESSN REFERENCES EMPLOYEE (SSN), PRIMARY KEY (Depname,ESSN));
DESC EMPLOYEE;
DESC DEPARTMENT;
DESC DEPT_LOCATION;
DESC PROJECT;
DESC WORKS_ON;
DESC DEPENDENT;


ALTER TABLE EMPLOYEE ADD LNAME VARCHAR(20);
ALTER TABLE EMPLOYEE ADD MINIT VARCHAR(20);


INSERT INTO EMPLOYEE(SSN, FNAME,BDATE,ADDRESS,SEX,SALARY,LNAME,MINIT) VALUES
('RNSECE01','RAHUL','10/JAN/1990','BANGALORE','M', 450000,'SINGH','M');
INSERT INTO EMPLOYEE(SSN, FNAME, BDATE, ADDRESS, SEX, SALARY,LNAME,MINIT) VALUES
('RNSCSE01','JAMES','15/JUN/1991','BANGALORE','M', 500000,'VARMA','D');
INSERT INTO EMPLOYEE(SSN, FNAME, BDATE, ADDRESS, SEX, SALARY,LNAME,MINIT) VALUES
('RNSCSE02','HEARN','16/MAY/1995','BANGALORE','M', 700000,'GUPTA','E');
INSERT INTO EMPLOYEE (SSN, FNAME, BDATE, ADDRESS, SEX, SALARY,LNAME,MINIT) VALUES
('RNSECE02','JOHN','10/JAN/1990','BANGALORE','M', 450000,'RAO','C');
INSERT INTO EMPLOYEE (SSN, FNAME, BDATE, ADDRESS, SEX, SALARY,LNAME,MINIT) VALUES
('RNSCSE03','JAMES','15/JUN/1991','BANGALORE','M', 500000,'SHETTY','D');
INSERT INTO EMPLOYEE (SSN, FNAME, BDATE, ADDRESS, SEX, SALARY,LNAME,MINIT) VALUES
('RNSCSE04','HEARN','16/MAY/1995','BANGALORE','M', 700000,'RAJ','P');
INSERT INTO EMPLOYEE (SSN, FNAME, BDATE, ADDRESS, SEX, SALARY,LNAME,MINIT) VALUES
('RNSCSE05','EDWARD','25/JUN/1993','MYSORE','M', 500000,'JOHN','A');
INSERT INTO EMPLOYEE (SSN, FNAME, BDATE, ADDRESS, SEX, SALARY,LNAME,MINIT) VALUES
('RNSECE05','PAVAN','28/JUL/1994','MANGALORE','M', 650000,'BHAT','E');


INSERT INTO DEPARTMENT VALUES ('1','ACCOUNTS','01/JAN/1991','RNSECE01');
INSERT INTO DEPARTMENT VALUES ('2','IT','01/AUG/1996','RNSCSE04');
INSERT INTO DEPARTMENT VALUES ('3','ECE','01/JUL/1998','RNSCSE01');
INSERT INTO DEPARTMENT VALUES ('4','ISE','01/AUG/2000','RNSCSE03');
INSERT INTO DEPARTMENT VALUES ('5','RESEARCH','01/JUN/2004','RNSCSE04');


INSERT INTO DEPT_LOCATION VALUES ('BANGALORE', '1');
INSERT INTO DEPT_LOCATION VALUES ('BANGALORE', '2');
INSERT INTO DEPT_LOCATION VALUES ('BANGALORE', '3');
INSERT INTO DEPT_LOCATION VALUES ('MANGALORE', '4');
INSERT INTO DEPT_LOCATION VALUES ('MANGALORE', '5');


INSERT INTO PROJECT VALUES (100,'IOT','BANGALORE','5');
INSERT INTO PROJECT VALUES (101,'CLOUD','BANGALORE','5');
INSERT INTO PROJECT VALUES (102,'BIGDATA','BANGALORE','5');
INSERT INTO PROJECT VALUES (103,'SENSORS','BANGALORE','3');
INSERT INTO PROJECT VALUES (104,'BANK MANAGEMENT','BANGALORE','1');
INSERT INTO PROJECT VALUES (105,'SALARY MANAGEMENT','BANGALORE','1');
INSERT INTO PROJECT VALUES (106,'OPENSTACK','BANGALORE','4');
INSERT INTO PROJECT VALUES (107,'SMART CITY','BANGALORE','2');


INSERT INTO WORKS_ON VALUES (4, 'RNSCSE01', 100);

INSERT INTO WORKS_ON VALUES (6, 'RNSCSE01', 101);

INSERT INTO WORKS_ON VALUES (8, 'RNSCSE01', 102);

INSERT INTO WORKS_ON VALUES (10, 'RNSCSE02', 100);

INSERT INTO WORKS_ON VALUES (3, 'RNSCSE04', 100);

INSERT INTO WORKS_ON VALUES (4, 'RNSCSE05', 101);

INSERT INTO WORKS_ON VALUES (5, 'RNSCSE02', 102);

INSERT INTO WORKS_ON VALUES (6, 'RNSCSE03', 102);

INSERT INTO WORKS_ON VALUES (7, 'RNSECE01', 103);

INSERT INTO WORKS_ON VALUES (5, 'RNSECE02', 104);

INSERT INTO WORKS_ON VALUES (6, 'RNSCSE05', 105);

INSERT INTO WORKS_ON VALUES (4, 'RNSCSE04', 106);

INSERT INTO WORKS_ON VALUES (10,'RNSCSE04', 107);
INSERT INTO DEPENDENT VALUES ('SITA','F','WIFE', 'RNSECE01');

INSERT INTO DEPENDENT VALUES ('RAMYA','F','SISTER','RNSECE05');

INSERT INTO DEPENDENT VALUES ('ROHITH','M','BROTHER','RNSCSE02');

INSERT INTO DEPENDENT VALUES ('ROHAN','M','BROTHER','RNSCSE01');

INSERT INTO DEPENDENT VALUES ('SOUMYA','F','DAUGHTER','RNSCSE04');




Select * from EMPLOYEE;

Select * from DEPARTMENT;

Select * from DEPT_LOCATION;

Select * from PROJECT;

Select * from WORKS_ON;

Select * from DEPENDENT;



ALTER TABLE EMPLOYEE RENAME TO EMPLO;

ALTER TABLE EMPLO RENAME COLUMN SUPERSSN TO MSSN;




                                        EXP: 2
Consider the following schema for Employee Database:
EMPLOYEE(Fname,Minit,Lname SSN, Bdate, Address, Sex, Salary, Mssn,DNO)
DEPARTMENT (Dept_name, Dnumber ,mgrssn , mgrstartdate)
DEPT_LOCATION (Dnumber,Dlocation)
PROJECT(Pname,Pnumber, Plocation, Dnum)
WORKS_ON(ESSN,Pno, Hours)
DEPENDENT(ESSN,Dname,Sex,Relationship)
Write SQL statements to
1. Display firstname ,date of birth , salary of female employees.
2. Retrieve the name , ssn and address of emplyees whose salary is greater than
50000.
3. Retrieve the name ,ssn and address of male employees whose salary is less than
30000.
4. Retrieve the SSN values of all employees.
5.Retrieve all the imformation from employees and the department, who work in
Department No 5.
6. Retrieve the birthday and address of employee whose name is ‘ Rahul M Singh’



1) INSERT INTO EMPLO (SSN, FNAME, BDATE, ADDRESS, SEX, SALARY, LNAME, MINIT)
   VALUES ('RNSCSE07','PAVANI','28/JUN/1994','MANGALORE','F', 650000,'RAO','S');

   SELECT FNAME, BDATE, SALARY FROM EMPLO WHERE SEX = 'F';


2) SELECT FNAME, LNAME, SSN, ADDRESS
   FROM EMPLO
   WHERE SALARY > 50000;

3) SELECT FNAME, LNAME, SSN, ADDRESS
   FROM EMPLO
   WHERE SALARY < 30000 AND SEX = 'M';

4) SELECT SSN FROM EMPLO;


5) UPDATE EMPLO SET DNO='1' WHERE SSN='RNSECE01';
   UPDATE EMPLO SET DNO='2' WHERE SSN='RNSCSE01';
   UPDATE EMPLO SET DNO='1' WHERE SSN='RNSCSE02';
   UPDATE EMPLO SET DNO='3' WHERE SSN='RNSECE02';
   UPDATE EMPLO SET DNO='4' WHERE SSN='RNSCSE03';
   UPDATE EMPLO SET DNO='5' WHERE SSN='RNSCSE04';
   UPDATE EMPLO SET DNO='2' WHERE SSN='RNSCSE05';
   UPDATE EMPLO SET DNO='3' WHERE SSN='RNSECE05';
   UPDATE EMPLO SET DNO='5' WHERE SSN='RNSCSE07';

   SELECT * FROM EMPLO;

6) SELECT BDATE, ADDRESS
   FROM EMPLO
   WHERE FNAME='RAHUL' AND MINIT='M' AND LNAME='SINGH';
                                      EXP: 3
Consider the following schema for Employee Database:
EMPLOYEE(Fname,Minit,Lname SSN, Bdate, Address, Sex, Salary, SUPERSSN,DNO)
DEPARTMENT (Dname, Dnumber ,mgrssn , mgrstartdate)
DEPT_LOCATION (Dnumber,Dlocation)
PROJECT(Pname,Pnumber, Plocation, Dnum)
WORKS_ON(ESSN,Pno, Hours)
DEPENDENT(ESSN,Dname,Sex,Relationship)
Write SQL statements to
1.Retrieve all the information from employee and department who works in
Research department
2.Retrieve the name and address of employees who work in research department.
2. Retrieve the details of all the employees who works in department 5 and salary is
between 30,000 and 40,000.
3. For every project located in ‘Bangalore’, list project number , the controlling
department number, department managers lastname, address and birthdate.
4. Retrieve the name of employees who have no dependents.
5.Retrieve the social security number of all employees who work on project number
1,2 or 3 .
6. Retrieve the name of all employees who do not have supervisiors.


1) SELECT E.*, D.*
   FROM EMPLO E
   JOIN DEPARTMENT D ON E.DNO = D.DNO
   WHERE D. DNAME = 'RESEARCH';

2) SELECT E.FNAME, E.LNAME, E.ADDRESS
   FROM EMPLO E
   JOIN DEPARTMENT D ON E.DNO = D.DNO
   WHERE D.DNAME = 'RESEARCH';

3) UPDATE EMPLO SET SALARY='35000' WHERE SSN='RNSCSE01';
   UPDATE EMPLO SET SALARY='39000' WHERE SSN='RNSCSE07';

   SELECT * FROM EMPLO;

   SELECT *
   FROM EMPLO
   WHERE DNO = 5 AND Salary BETWEEN 30000 AND 40000;

4) SELECT P.PNO, P.DNO, D. MGRSSN, E. LNAME AS Last_Name, E. ADDRESS AS Address, E.
   BDATE AS Birthdate
   FROM PROJECT P
   JOIN DEPARTMENT D ON P.DNO = D.DNO
   JOIN EMPLO E ON D. MGRSSN = E.SSN
   WHERE P. PLOCATION = 'BANGALORE';

5) SELECT DISTINCT E.FNAME, E.LNAME
   FROM EMPLO E
   LEFT JOIN DEPENDENT D ON E.SSN = D.SSN
   WHERE D.SSN IS NULL;

6) SELECT E.SSN
   FROM EMPLO E
   JOIN WORKS_ON W ON E.SSN = W.SSN
   WHERE W.PNO IN (101,102, 103);

7) SELECT FNAME, LNAME
   FROM EMPLO
   WHERE MSSN IS NULL;


                                   EXP: 4
Consider the following schema for Employee Database:
EMPLOYEE(Fname,Minit,Lname SSN, Bdate, Address, Sex, Salary, SUPETSSN,DNO)
DEPARTMENT (Dname, Dnumber ,mgrssn , mgrstartdate)
DEPT_LOCATION (Dnumber,Dlocation)
PROJECT(Pname,Pnumber, Plocation, Dnum)
WORKS_ON(ESSN,Pno, Hours)
DEPENDENT(ESSN,Dname,Sex,Relationship)
Write SQL statements to
1. Find the sum of salaries of all employee, maximum salary, minimum salary and
average salary.
2. Find the sum of salaries of employees of ‘Research ‘department as well as
maximum salary ,minimum salary and average salary in this department.
3. Retrieve the total number of employees in the ‘Research Department’.
4. Count the number of distinct salary values in the database.
5. Retrieve the names of all employees who have two or more dependents.


1) SELECT
   SUM(SALARY) AS TotalSalary,
   MAX(SALARY) AS MaxSalary,
   MIN(SALARY) AS MinSalary,
   AVG(SALARY) AS AvgSalary
   FROM EMPLO;

2) SELECT
   SUM(E.SALARY) AS TotalSalary,
   MAX(E.SALARY) AS MaxSalary,
   MIN(E.SALARY) AS MinSalary,
   AVG(E.SALARY) AS AvgSalary
   FROM EMPLO E
   JOIN DEPARTMENT D ON E.DNO = D.DNO
   WHERE D.DNAME= 'RESEARCH';




3) SELECT COUNT(*) AS TotalEmployees
   FROM EMPLO E
   JOIN DEPARTMENT D ON E.DNO = D.DNO
   WHERE D.DNAME = 'RESEARCH';

4) SELECT COUNT(DISTINCT SALARY) AS DistinctSalaryCount
   FROM EMPLO;
                                     EXP: 5
Consider the following schema for Employee Database:
EMPLOYEE(Fname,Minit,Lname SSN, Bdate, Address, Sex, Salary, SUPERSSN, DNO)
DEPARTMENT (Dname, Dnumber ,mgrssn , mgrstartdate)
DEPT_LOCATION (Dnumber,Dlocation)
PROJECT(Pname,Pnumber, Plocation, Dnum)
WORKS_ON(ESSN,Pno, Hours)
DEPENDENT(ESSN,Dname,Sex,Relationship)
Write SQL statements to
1 Retrieve all employees whose address is in Bangalore.
2. Retrieve all employees who were born during the 1950s.
3. Show the effect of giving10% raise to all employees who work on the 'DBMS'
project.
4. Retrieve a list of employees and their projects in which they work, order by the
employee's department.
5. Change the location and controlling department number of the employees from
‘Bangalore’ to 'Bellaire' and project number 10 to 5 respectively.
6. Create a view with view name WORKSON1 retrieving the following information:
firstname, lastname, project name and no of hours for employee who works on
project.


1) SELECT *
   FROM EMPLO
   WHERE ADDRESS LIKE '%BANGALORE%';

2) SELECT *
   FROM EMPLO
   WHERE BDATE BETWEEN '01/JAN/1990' AND '31/DEC/1994';

3) UPDATE EMPLO
   SET SALARY = SALARY * 1.10
   WHERE SSN IN (SELECT SSN FROM WORKS_ON WHERE PNO = (SELECT PNO
   FROM PROJECT WHERE PNAME ='CLOUD'));

   SELECT * FROM EMPLO;

4) SELECT E. FNAME, E. LNAME, P. PNAME
   FROM EMPLO E
   JOIN WORKS_ON W ON E.SSN = W.SSN
   JOIN PROJECT P ON W.PNO = P.PNO
   ORDER BY E.DNO;

5) UPDATE DEPT_LOCATION
   SET DLOC = 'BELLAIRE'
   WHERE DNO IN (SELECT DNO FROM EMPLO WHERE ADDRESS LIKE 'BANGALORE');

   SELECT * FROM DEPT_LOCATION;

   UPDATE PROJECT
   SET DNO = 5
   WHERE PNO = 103;

   SELECT * FROM PROJECT;

6) CREATE VIEW WORKSON AS
   SELECT E. FNAME, E. LNAME, P. PNAME, W. HOURS
   FROM EMPLO E
   JOIN WORKS_ON W ON E.SSN = W.SSN
   JOIN PROJECT P ON W.PNO = P.PNO;

   SELECT * FROM WORKSON;



                                   EXP: 6
Consider the following schema
EMP(EMPNO,ENAME,JOB,MGR,HIREDATE, SAL,COMM,DEPTNO)
EMPCHGLOG(SYSDATE, EMPNO,ACTION)
1.Write a trigger (EMP_COMM_TRIG) which calculates the commission of every new
employee belonging to department 30 before a record for that employee is inserted
into the EMP table.
2.When an employee row is deleted from the EMP table, the trigger
(EMP_DEL_TRIG) adds a row to the EMPCHGLOG table with a description of the
action.


1) CREATE TABLE EMP(NAME VARCHAR(50),AGE NUMBER,SALARY NUMBER,COMM
   NUMBER,DNO NUMBER);

   INSERT INTO EMP VALUES('ANU',21,10000,3500,20);

   SELECT * FROM EMP;

   CREATE OR REPLACE TRIGGER EMP_COMM_TRIG
   BEFORE INSERT ON EMP
   FOR EACH ROW
   BEGIN
    IF :NEW.DNO = 30 THEN
    :NEW.COMM := :NEW.SALARY * 0.1;
    ELSE
    :NEW.COMM := NULL;
    END IF;
   END;
   /

   INSERT INTO EMP VALUES('MANJU',20,15000,3000,30);

   SELECT * FROM EMP;

2) CREATE TABLE EMP_1(EMP_ID NUMBER,EMPNAME VARCHAR(20),ACTION
   VARCHAR(50),CHANGE_DATE DATE);

   CREATE TABLE EMP_2(EMP_ID NUMBER,EMPNAME VARCHAR(20),ACTION
   VARCHAR(50),CHANGE_DATE DATE);

   INSERT INTO EMP_1 VALUES(121,'ARYA','INSERT','02/JAN/2020');
   INSERT INTO EMP_1 VALUES(122,'RAMYA','INSERT','05/JAN/2020');

   SELECT * FROM EMP_1;

   CREATE OR REPLACE TRIGGER EMP_DEL_TRIG2
   AFTER DELETE ON EMP_1
   FOR EACH ROW
   BEGIN
    INSERT INTO EMP_2(EMP_ID,EMPNAME,ACTION,CHANGE_DATE)
      VALUES (:OLD.EMP_ID, :OLD.EMPNAME, 'DELETE',SYSTIMESTAMP);
     END;
     /

     DELETE FROM EMP_1 WHERE EMP_ID=121;

     SELECT * FROM EMP_2 WHERE EMP_ID=121;



                                      EXP: 7
1. Write a Program to insert one document into a collection in MongoDB Database
2. Write a program code to perform CRUD operations.


! pip install pymongo
from pymongo import MongoClient
MongoConn = MongoClient()
amri = MongoConn["amri"]
students = amri["amri"]
students.insert_one({
"firstName":"Student",
"lastName": "One",
"age": 20,
"marks": 85
})
students.insert_many([
{"firstName": "Student", "lastName": "Two", "age": 22, "marks": 90},
{"firstName": "Student", "lastName": "Three", "age": 21, "marks": 75}
])


all_records = students.find()
print(list(all_records))
result = students.find_one({"age": 22})
print(result)


students.update_one(
{"age": 21},
{"$set": {"marks": 100}}
)


students.update_many(
{},
{"$inc": {"marks": 99}}
)
